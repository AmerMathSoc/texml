%% AMS prddvilualatex

\documentclass{amsart}

\csname noTeXMLhistory\endcsname

\nofiles

\usepackage{texml}

\ifTeXML
    \usepackage{Listings}
    \def\kwd{\XMLelement{kwd}}
    \def\id{\XMLelement{id}}
    \def\str{\XMLelement{str}}
    \def\comment{\XMLelement{comment}}
\else
    \usepackage{listings}
    \def\kwd#1{{\color{blue}\textbf{#1}}}
    \def\id#1{{\color{red}\textbf{#1}}}
%    \def\str#1{{\color{green}#1}}
    \def\comment#1{{\color{green}#1}}
\fi

\usepackage{xcolor}

\title{listings}

\lstset{
    morecomment=[l]{\#},
    morecomment=[s]{/*}{*/},
    morecomment=[n]{(*}{*)},
    commentstyle=\comment,
}

\begin{document}

\maketitle

hello, world

\begin{lstlisting}
while (<>) {
    chomp;

    # comment

    /* C-style comment */

    /* Non-/*nesting*/ comment */

    (* nested (* comment *) *)

    print "string";
}
\end{lstlisting}

\end{document}
