%% AMS prddvilualatex

\documentclass{amsart}

\csname noTeXMLhistory\endcsname

\nofiles

\usepackage{texml}

\ifTeXML
    \usepackage{Listings}
    \def\kwd{\XMLelement{kwd}}
    \def\id{\XMLelement{id}}
    \def\str{\XMLelement{str}}
    \def\comment{\XMLelement{comment}}
\else
    \usepackage{listings}
    \def\kwd#1{{\color{blue}\textbf{#1}}}
    \def\id#1{{\color{red}\textbf{#1}}}
    \def\str#1{{\color{green}#1}}
    \def\comment#1{{\color{green}#1}}
\fi

\usepackage{xcolor}

\title{listings}

\begin{document}

\maketitle

hello, world

\lstset{identifierstyle=\id}

\lstset{morecomment=[l]{//}}
\lstset{commentstyle=\comment}

\begin{lstlisting}[escapechar=!]
// calc!ulate $a_{ij}$!
   !$a_{ij} = a_{jj}/a_{ij}$!;
\end{lstlisting}

\begin{lstlisting}[escapechar=\%]
// calc%ulate $a_{ij}$%
   %$a_{ij} = a_{jj}/a_{ij}$%;
\end{lstlisting}

\begin{lstlisting}[escapechar={^}]
// calc^ulate $a_{ij}$^
   ^$a_{ij} = a_{jj}/a_{ij}$^;
\end{lstlisting}

\end{document}
