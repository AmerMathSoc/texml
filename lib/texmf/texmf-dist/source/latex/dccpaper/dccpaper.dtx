% \iffalse meta-comment
%<*internal|ijdc9|idcc|base>
\def\Version{2015/06/22 v1.4.1}
%</internal|ijdc9|idcc|base>
%<*internal>
\iffalse
%</internal>
%<*readme>
The dccpaper bundle: LaTeX classes for submissions to IJDC and IDCC
===================================================================

The dccpaper bundle consists of two very similar classes.

ijdc-v9.cls corresponds to the template used by the `International
Journal of Digital Curation`_, beginning with volume 9.

idcc.cls corresponds to the template used for the `International Digital
Curation Conference`_, beginning with IDCC15.

As the classes are so similar, their common features are abstracted out
into dccpaper-base.tex, which should be installed in the runtime tex
directory, rather than with the documentation.

The classes are suitable for submissions to the respective review
boards, but can also be used to produce the final camera-ready papers.

Installation
------------

Managed way
~~~~~~~~~~~

The latest stable release of the dccpaper bundle has been packaged for
TeX Live and MiKTeX. If you are running TeX Live and have ``tlmgr``
installed, you can install the bundle simply by running
``tlmgr install dccpaper``. If you are running MiKTeX, you can install
the bundle by running ``mpm --install=dccpaper``. Both ``tlmgr`` and
``mpm`` have GUI versions that you might find friendlier.

Automated way
~~~~~~~~~~~~~

A makefile is provided which you can use with the Make utility:

-  Running ``make`` generates the derived files

   -  README
   -  dccpaper.pdf
   -  ijdc-v9.cls
   -  idcc.cls
   -  dccpaper-base.tex
   -  dccpaper-apacite.bib
   -  dccpaper-biblatex.bib

-  Running ``make inst`` installs the files in the user's TeX tree.
-  Running ``make install`` installs the files in the local TeX tree.

Manual way
~~~~~~~~~~

1. Compile dccpaper.dtx just as you would a normal LaTeX file. Bear in
   mind the documentation requires the Biblatex package and the Biber
   tool rather than regular BibTeX. As well as the usual PDF (or DVI)
   and auxiliary files, several others are generated.
2. Rename README.txt to README (if you like).
3. Move the files to your TeX tree as follows:

   -  ``source/latex/dccpaper``: dccpaper.dtx, dccpaper.ins
   -  ``tex/latex/dccpaper``: ijdc-v9.cls, idcc.cls, dccpaper-base.tex,
      dccpaper-by.eps, dccpaper-by.pdf
   -  ``doc/latex/dccpaper``: dccpaper.pdf, dccpaper-apacite.bib,
      dccpaper-biblatex.bib, README

4. You may then have to update your installation's file name database
   before TeX and friends can see the files.

Licence
-------

Copyright 2015 Digital Curation Centre, University of Edinburgh.

This work consists of the image files dccpaper-by.eps and
dccpaper-by.pdf, the documented LaTeX file dccpaper.dtx and a Makefile.

The text files contained in this work may be distributed and/or modified
under the conditions of the `LaTeX Project Public License (LPPL)`_,
either version 1.3c of this license or (at your option) any later
version.

The image files distributed with this bundle derive from the file
`by.eps`_ distributed by Creative Commons. The image is a trademark of
Creative Commons and is subject to the `Creative Commons trademark
policy`_.

This work is "maintained" (as per LPPL maintenance status) by `Alex
Ball`_.

.. _International Journal of Digital Curation: http://www.ijdc.net/index.php/ijdc
.. _International Digital Curation Conference: http://www.dcc.ac.uk/events/international-digital-curation-conference-idcc
.. _LaTeX Project Public License (LPPL): http://www.latex-project.org/lppl.txt
.. _by.eps: http://mirrors.creativecommons.org/presskit/buttons/88x31/eps/by.eps
.. _Creative Commons trademark policy: http://creativecommons.org/policies
.. _Alex Ball: http://alexball.me.uk/
%</readme>
%<ijdc9|idcc>\NeedsTeXFormat{LaTeX2e}[1999/12/01]
%<ijdc9>\ProvidesClass{ijdc-v9}
%<idcc>\ProvidesClass{idcc}
%<base>\ProvidesFile{dccpaper-base.tex}
%<*ijdc9>
    [\Version\space Class for submissions to the International Journal of Digital Curation, volume 9 onwards.]
%</ijdc9>
%<*idcc>
    [\Version\space Class for submissions to the International Digital Curation Conference.]
%</idcc>
%<*base>
    [\Version\space Common class code for IJDC and IDCC papers.]
%</base>
%<*ijdc9>
%<<LITERATE
%
% The type of paper is recorded in |\dccp@type|. The possible values are
% `General Article', `Peer-Reviewed Paper', or `Editorial'.
% The latter is provided through the constant |\dccp@editorial| so we can
% test for it later with ease.
%
\def\dccp@type{General Article}
\def\dccp@editorial{Editorial}
%
% These three options set |\dccp@type| appropriately. The |editorial|
% option additionally switches page numbers to roman numerals.
% The |article| option is redundant, but included for symmetry.
%
\DeclareOption{editorial}{\let\dccp@type=\dccp@editorial%
  \AtBeginDocument{% Editorials use Roman numerals for page numbers
    \pagenumbering{roman}%
    \renewcommand{\thelastpage}{\@roman\c@lastpage}%
  }%
}
\DeclareOption{paper}{\def\dccp@type{Peer-Reviewed Paper}}
\DeclareOption{article}{\def\dccp@type{General Article}}
\ProcessOptions\relax

%
% These definitions are used to fill out the headers and footers. They include 
% some details that are defined in \textsf{dccpaper-base.tex} and provided by
% the user: |\thedate|, |\thevolume|, |\theissue|, |\thelastpage|, |\thedoi|.
%
\def\dccp@publ@long{International Journal of Digital Curation}
\def\dccp@publ@short{IJDC}
\def\dccp@publ@msg{The \emph{\dccp@publ@long} is an international journal
committed to scholarly excellence and dedicated to the advancement of digital
curation across a wide range of sectors. The \dccp@publ@short\ is published by
the University of Edinburgh on behalf of the Digital Curation Centre. ISSN:
1746-8256. URL: \url{http://www.ijdc.net/}}
\def\dccp@titlefoot@bib{%
  \dccp@publ@long\\
  \thedate, Vol.\ \thevolume, Iss.\ \theissue, \thepage--\thelastpage.%
}
\def\dccp@titlefoot@doi{%
  \url{http://dx.doi.org/\thedoi}\\
  DOI: \thedoi
}
\def\dccp@normhead@doi{doi:\thedoi}
%
% |\dccp@subject| will be used for the PDF subject, and will specify the journal 
% and the issue.
%
\def\dccp@subject{\dccp@publ@long, \thedate, Vol.\ \thevolume, Iss.\ \theissue}

%
% The rest of the formatting happens in the following file.
%
\input{dccpaper-base}
%LITERATE
%</ijdc9>
%<*idcc>
%<<LITERATE
%
% These definitions are used to fill out the headers and footers.
% The ones for |\dccp@publ@short| and |\dccp@publ@msg| are a fallback,
% defined here but ordinarily overridden using a package option.
%
\def\dccp@publ@long{International Digital Curation Conference}
\def\dccp@publ@short{IDCC}
\def\dccp@publ@msg{The \dccp@publ@long\ takes place on [TBC] in [TBC]. URL: 
\url{http://www.dcc.ac.uk/events/international-digital-curation-conference-idcc}}
%
% |\dccp@subject| will be used for the PDF subject. The value here is again a
% fallback, ordinarily overridden using a package option.
%
\def\dccp@subject{\dccp@publ@long}

%
% Paper type is recorded in |\def\dccp@type|. The values can be 
% `Research Paper', `Practice Paper', `Poster', `Demonstration', or `Workshop'.
%
\def\dccp@type{Practice Paper}
%
% These options set the value of |\def\dccp@type| appropriately.
% The |practice| option is redundant, but included for symmetry.
%
\DeclareOption{research}{\def\dccp@type{Research Paper}}
\DeclareOption{data}{\def\dccp@type{Data Paper}}
\DeclareOption{poster}{\def\dccp@type{Poster}}
\DeclareOption{demo}{\def\dccp@type{Demonstration}}
\DeclareOption{bof}{\def\dccp@type{Birds of a Feather}}
\DeclareOption{workshop}{\def\dccp@type{Workshop}}
\DeclareOption{practice}{\def\dccp@type{Practice Paper}}
%
% The details for each conference are slightly different, so they each have an
% associated option for overriding the fallback definitions for
% |\dccp@publ@short|, |\dccp@publ@msg| and |\dccp@subject|.
%
\DeclareOption{15}{%
  \def\dccp@publ@short{IDCC15}
  \def\dccp@publ@msg{The 10th \dccp@publ@long\ takes place on 9--12 February
  2015 in London. URL: \url{http://www.dcc.ac.uk/events/idcc15/}}
  \def\dccp@subject{10th \dccp@publ@long, 2015}
}
\DeclareOption{16}{%
  \def\dccp@publ@short{IDCC16}
  \def\dccp@publ@msg{The 11th \dccp@publ@long\ takes place on 22--25 February
  2016 in Amsterdam. URL: \url{http://www.dcc.ac.uk/events/idcc16/}}
  \def\dccp@subject{11th \dccp@publ@long, 2016}
}
\ProcessOptions\relax

%
% The |demo| option, if passed, would be passed on to the \textsf{graphics}
% package wreaking havoc with each and every included image. To avoid this,
% we clear it from the list of class options using
% \href{http://tex.stackexchange.com/q/33245}{code from Enrico Gregorio}.
%
\def\@clearglobaloption#1{%
  \def\@tempa{#1}%
  \def\@tempb{\@gobble}%
  \@for\next:=\@classoptionslist\do{%
    \ifx\next\@tempa
      \message{Option \next\space has been hidden from subsequent packages}%
    \else
      \edef\@tempb{\@tempb,\next}%
    \fi
  }%
  \let\@classoptionslist\@tempb
  \expandafter\ifx\@tempb\@gobble
    \let\@classoptionslist\@empty
  \fi
}
\@clearglobaloption{demo}

%
% The rest of the formatting happens in the following file.
%
\input{dccpaper-base}
%LITERATE
%</idcc>
%<*base>
%<<LITERATE
%
% The \textsf{dccpaper} classes are deliberately very similar. This file 
% contains the common code. All the classes are based on the \textsf{article} 
% class, and use A4 paper.
%
\LoadClass[a4paper,12pt,twoside]{article}

%
% We use British English orthography.
%
\RequirePackage[british]{babel}
%
% The macro patching commands from \textsf{etoolbox} come in useful for handling 
% author and date information, and also for compatibility with \textsf{apacite}.
%
\RequirePackage{etoolbox}
%
% The \textsf{dccpaper} classes use Times as the main text font. We prefer 
% \textsf{newtx} as it provides support for mathematics, but the standard 
% \textsf{times} package will do. In case they are needed, we also provide 
% Helvetica for the sans serif font and Computer Modern Teletype for the
% monospaced.
%
\RequirePackage[T1]{fontenc}
\IfFileExists{newtxtext.sty}%
  {\RequirePackage{newtxtext,newtxmath}}%
  {\RequirePackage{times}}
\RequirePackage[scaled=0.92]{helvet}
\renewcommand{\ttdefault}{cmtt}
%
% We will need support for included graphics and colour. The structural elements 
% are a medium turquoise, while the links are slightly darker to make them 
% easier to read on screen.
%
\RequirePackage{graphicx}
\IfFileExists{xcolor.sty}%
  {\RequirePackage{xcolor}}%
  {\RequirePackage{color}}
\definecolor[named]{struct}{rgb}{0,0.5,0.5}
\definecolor[named]{links}{rgb}{0,0.4,0.4}
%
% We will calculate some lengths later.
%
\RequirePackage{calc}

%
% Ragged right text is easier to read on screen, but fully justified text looks
% better. The |\raggedyright| layout from Peter Wilson's \textsf{memoir} class 
% (2005/09/25 v1.618) is an excellent compromise. The code below replicates it.
%
% First we save the original definitions of |\\| and |\parindent| as 
% |\OrigLineBreak| and |\RaggedParindent| respectively.
%
\let\OrigLineBreak\\
\newdimen\RaggedParindent
\setlength{\RaggedParindent}{\parindent}

%
% The |\raggedyright| layout more or less lays text out as with full 
% justification, but then lets the shorter lines relax a bit from the right
% margin. It is the default for DCC papers.
%
\newcommand{\raggedyright}[1][2em]{%
  \let\\\@centercr\@rightskip \z@ \@plus #1\relax
  \rightskip\@rightskip
  \leftskip\z@skip
  \parindent\RaggedParindent}
\AtBeginDocument{\raggedyright}

%
% The |\flushleftright| layout restores full justification, in case it is
% needed.
%
\newcommand*{\flushleftright}{%
  \let\\\OrigLineBreak
  \leftskip\z@skip
  \rightskip\leftskip
  \parfillskip\@flushglue
  \everypar{}}

%
% Pdf\TeX\ 1.40.15 introduced the facility to include dummy interword spaces
% to improve text extraction and reflow. We test for this facility and use it
% if available.
%
\RequirePackage{ifpdf}
%LITERATE
%<base>\ifpdf
%<base>  \ifdef{\pdfinterwordspaceon}{\pdfinterwordspaceon}{}
%<base>\fi
%<<LITERATE

%
% The classes have some special metadata requirements. We start with the author
% information.
%
% The macro |\thecorrespondence| is used in the title page footer for the name, 
% postal address and email address of the corresponding author.
%
\def\thecorrespondence{}
\newcommand*{\correspondence}[1]{\def\thecorrespondence{#1}}
%
% The handling of authors here is inspired by Patrick W Daly's \textsf{authblk}, 
% (2001/02/27 1.3), and defines the familiar user commands. Authors are 
% presented in blocks, one affiliation but perhaps several authors per block.
%
% We make the presentation of the author information configurable (just in case)
% with some hooks and lengths:
% \begin{itemize}
% \item |\Authfont| is the font used for author names;
% \item |\Affilfont| is the font used for affiliations;
% \item |\affilsep| is the line spacing between author names and affiliations;
% \item |\authblksep| is the line spacing between author name/affiliation 
%       blocks.
% \end{itemize}
%
\newcommand*{\Authfont}{\normalfont}
\newcommand*{\Affilfont}{\normalfont\small}
\newlength{\affilsep}\setlength{\affilsep}{0pt}
\newlength{\authblksep}\setlength{\authblksep}{1.5\baselineskip}
%
% The |\AuthorBlock| command will be used to collect all the author information.
%
\newcommand{\AuthorBlock}{}
%
% The |\MainAuthor| command collects abbreviated author information for use in 
% the headers.
%
\newcommand{\MainAuthor}{}
%
% The |\dccp@author| command, meanwhile, collects a full list of authors for the
% PDF metatdata.
% 
\newcommand{\dccp@author}{}
%
% We define counters for 
% \begin{itemize}
% \item the total number of authors defined;
% \item the number of authors in the current block;
% \item the number of blocks defined.
% \end{itemize}
%
\newcounter{authors}
\newcounter{authorsinblock}
\newcounter{block}
%
% The |block| counter will increase once in the preamble, and again when the
% information is typeset, so we need to reset it at the beginning of the
% document.
%
\AtBeginDocument{\setcounter{block}{0}}
%
% The new definition of the author command starts here.
%
\renewcommand{\author}[1]{%
%
% If this is the first or second |\author| command, we add the name to our 
% abbreviated list of authors. Otherwise, we replace the name of the second 
% and subsequent authors with `et al.' in that list.
% 
% At the same time, we use a simpler technique to populate |\dccp@author|.
%
  \ifnum\theauthors=0
    \def\dccp@author{#1}%
    \def\MainAuthor{#1}%
  \else
    \appto\dccp@author{, #1}%
    \ifnum\theauthors=1%
      \def\OtherMainAuthors{ and #1}%
      \appto\MainAuthor{\OtherMainAuthors}%
    \else
      \ifnum\theauthors=2%
        \def\OtherMainAuthors{ et al.}%
      \fi
    \fi
  \fi
  \stepcounter{authors}%
%
% Each block has its author names collected in a macro like |\blocki@auth|,
% and its affiliation collected in a macro like |\blocki@affil| (the `i' is a
% serial number).
%
% If this is the first author in a block, we need to create the block and add it 
% to |\AuthorBlock|; second and subsequent blocks are preceded by a |\quad| of 
% space. 
%
  \ifnum\theauthorsinblock=0%
    \stepcounter{block}%
    \expandafter\def\csname block\roman{block}@auth\endcsname{\Authfont#1}%
    \ifnum\theblock>1\appto\AuthorBlock{\quad}\fi
    \appto\AuthorBlock{%
      \stepcounter{block}%
      \begin{minipage}[t]{0.45\textwidth}\centering
      \csname block\roman{block}@auth\endcsname
      \ifx\undefined\csname block\roman{block}@affil\endcsname
      \else
        \\[\affilsep]\csname block\roman{block}@affil\endcsname
      \fi
      \end{minipage}%
      \rule{0pt}{2\baselineskip}%
      }
  \else
%
% Otherwise we just add the name to the right |\blocki@auth|-style macro.
%
    \csappto{block\roman{block}@auth}{, #1}%
  \fi
  \stepcounter{authorsinblock}%
}
%
% The |\affil| command adds an affiliation to the current block and closes it by
% resetting the |authorsinblock| counter.
%
\newcommand{\affil}[1]{%
  \expandafter\def\csname block\roman{block}@affil\endcsname{\Affilfont#1}%
  \setcounter{authorsinblock}{0}%
}

%
% The |\HeadTitle| collects the abbreviated title for use in the headers.  
%
\newcommand*{\HeadTitle}{}
%
% We wrap the normal |\title| command with code to populate |\HeadTitle| with
% the optional argument if provided, or the mandatory one otherwise. We also 
% provide a persistent |\thetitle| macro, stripped of any |\thanks|.
%
\let\ProperTitle=\title
\renewcommand{\title}[2][\empty]{
  \ifx\empty #1%
    \renewcommand*{\HeadTitle}{#2}%
  \else
    \renewcommand*{\HeadTitle}{#1}%
  \fi%
  \begingroup\let\footnote\@gobble
  \ProperTitle{#2}%
  \begingroup
    \renewcommand{\thanks}[1]{}
    \protected@xdef\thetitle{#2}
  \endgroup\endgroup
}
%
% To prevent \LaTeX\ throwing an error if no title is supplied, we supply a
% fallback value and issue a warning instead.
%
\def\thetitle{%
  Please supply a title
  \ClassWarning{dccpaper}{%
    Please supply a title in the preamble with \noexpand\title{}%
  }
}

%
% We make |\thedate| persistent, borrowing the technique used in Peter Wilson's 
% \textsf{memoir} class (2005/09/25 v1.618).
%
\pretocmd{\date}{\begingroup\let\footnote\@gobble}{}{}%
\apptocmd{\date}{%
  \begingroup
    \renewcommand{\thanks}[1]{}
    \protected@xdef\thedate{#1}
  \endgroup\endgroup%
}{}{}
%
% We ensure |\thedate| is defined using a dummy date.
%
\date{20xx}

%
% IJDC articles have extra bibliographic information:
% \begin{itemize}
% \item |\volume| sets the volume number, |\thevolume|;
% \item |\issue| sets the issue number, |\theissue|;
% \item |\subno| sets the submission number, |\thesubno|.
% \end{itemize}
% 
% These numbers are used to build the DOI, |\thedoi|.
%
\newcommand*{\thevolume}{0}
\newcommand*{\volume}[1]{\renewcommand*{\thevolume}{#1}}
\newcommand*{\theissue}{0}
\newcommand*{\issue}[1]{\renewcommand*{\theissue}{#1}}
\newcommand*{\thesubno}{0}
\newcommand*{\subno}[1]{\renewcommand*{\thesubno}{#1}}
\newcommand*{\thedoi}{10.2218/ijdc.v\thevolume i\theissue .\thesubno}
%
% They also display the page range. The following code was borrowed from Peter 
% Wilson's \textsf{memoir} class (2005/09/25 v1.618). It defines a counter 
% |lastpage| which, on the second run, will contain the number of the last page.
%
\newcounter{lastpage}
\setcounter{lastpage}{0}
\newcommand{\dol@stpage}{%
  \if@filesw
    \addtocounter{page}{-1}%
    \immediate\write\@auxout%
      {\string\setcounter{lastpage}{\the\c@page}}%
    \stepcounter{page}%
  \fi
}
\AtBeginDocument{\AtEndDocument{\clearpage\dol@stpage}}

%
% DCC papers display some important dates. We collect these in |\dccp@dates|, 
% initially setting the value to something sensible for papers in draft.
%
\def\dccp@dates{\emph{Draft from} \today}
%
% Several types of date can be added:
% \begin{itemize}
% \item |\submitted| for when the authors submitted the paper (intended for
%       IDCC papers).
% \item |\received| for when the paper was received by the editorial board 
%       (intended for IJDC papers).
% \item |\revised| for when the most recent version was received by the 
%       editorial board.
% \item |\accepted| for when the paper was accepted by the editorial board.
% \end{itemize}
%
\newcommand*{\submitted}[1]{%
  \def\dccp@dates{\emph{Submitted} #1}}
\newcommand*{\received}[1]{%
  \def\dccp@dates{\emph{Received} #1}}
\newcommand*{\revised}[1]{%
  \appto\dccp@dates{%
    \space\space\space\textbar\space\space\space
    \emph{Revision received} #1}%
  }
\newcommand*{\accepted}[1]{%
  \appto\dccp@dates{%
    \space\space\space\textbar\space\space\space
    \emph{Accepted} #1}%
  }
%
% IJDC papers need to say if they had a previous life as a conference paper. 
% This statement goes in |\dccp@conf|, which is initially empty. The user 
% command for setting this text is |\conference|.
%
\let\dccp@conf=\empty
\newcommand*{\conference}[1]{%
  \renewcommand*{\dccp@conf}{An earlier version of this paper was presented at #1.}%
}

%
% The macro |\FixTextHeight| will be useful when switching from the first page
% geometry to the regular geometry for the rest of the paper. It is based on
% code from  Hideo Umeki's \textsf{geometry} package (2002/07/08 v3.2).
%
\newcommand{\FixTextHeight}{%
  \setlength\@tempdima{\textheight}%
  \addtolength\@tempdima{-\topskip}%
  \@tempcnta\@tempdima
  \@tempcntb\baselineskip
  \divide\@tempcnta\@tempcntb
  \setlength\@tempdimb{\baselineskip}%
  \multiply\@tempdimb\@tempcnta
  \advance\@tempdima-\@tempdimb
  \global\advance\footskip\@tempdima
  \multiply\@tempdima\tw@
  \ifdim\@tempdima>\baselineskip
    \addtolength\@tempdimb{\baselineskip}%
    \global\advance\footskip-\baselineskip
  \fi
  \addtolength\@tempdimb{\topskip}%
  \global\textheight\@tempdimb
}

%
% The width of the textblock (on all pages) is 150mm, which on A4 paper implies 
% margins of 30mm each. (Making both horizontal margins the same in a two-sided
% context makes the paper more pleasant to read on screen). 
%
\setlength{\textwidth}{150mm}
\setlength{\oddsidemargin}{30mm - \hoffset - 1in}
\setlength{\evensidemargin}{30mm - \hoffset - 1in}
%
% It is rare to have marginal notes, but in case we ever do, we centre them in
% the margin.
%
\setlength{\marginparwidth}{30mm - 2\marginparsep}
%
% We also want a distance of 15mm from the top of the page to the top of the 
% header, and two blank lines between the bottom of the header and the top of 
% the textblock.
%
\setlength{\topmargin}{15mm - \voffset - 1in}
\setlength{\headsep}{2\baselineskip}

%
% IJDC editorials have slightly different headers and footers. This requires
% testing for |\dccp@editorial| if it exists. In case it doesn't, we provide it.
%
\providecommand{\dccp@editorial}{Editorial}
%
% The height of the footer can vary a lot. To keep it a fixed distance from the
% bottom of the page rather than the top, we need to vary the |\textheight| 
% accordingly. This means we need to measure the height of the footer. (The 
% header is more predictable but we may as well measure it while we are at it).
%
% Here we define the header and footer of the title page (i.e.\ the 
% \textsf{title} page style), making sure we save them to auxiliary macros 
% |\TitleHead| and |\TitleFoot| so we can measure them.
%
\def\ps@title{%
  \def\@oddhead{%
    \begin{minipage}{\textwidth}%
      \centering
      \LARGE\bfseries\color{struct}%
      \ifx\dccp@type\dccp@editorial
        \dccp@publ@long
      \else
        \dccp@publ@short\space\space\textbar\space\space\emph{\dccp@type}%
      \fi
      \par
    \end{minipage}%
  }%
  \let\@evenhead=\@oddhead
  \let\TitleHead=\@oddhead
  \def\@oddfoot{%
    \begin{minipage}[b]{\textwidth}%
      \fontsize{9pt}{11pt}\selectfont
      \ifx\dccp@type\dccp@editorial
      \else
        {\centering\dccp@dates\par}
        \bigskip
        Correspondence should be addressed to \thecorrespondence\par
        \bigskip
      \fi
      \ifx\empty\dccp@conf
      \else
        \dccp@conf\par
        \bigskip
      \fi
      \dccp@publ@msg\par
      \bigskip
      \begin{minipage}[b]{\linewidth - 25mm}
      Copyright rests with the authors. This work is released under a Creative
      Commons Attribution 4.0 International Licence. For details please see
      \url{http://creativecommons.org/licenses/by/4.0/}%
      \end{minipage}\hfill
      \begin{minipage}[b]{19mm}
        \href{http://creativecommons.org/licenses/by/4.0/}%
          {\includegraphics[width=\hsize]{dccpaper-by}}%
      \end{minipage}
      \par
      \bigskip
      \makebox[0pt][l]{\parbox{0.4\hsize}{%
        \ifx\undefined\dccp@titlefoot@bib\else\dccp@titlefoot@bib\fi
      }}\hfill
      \makebox[0pt][c]{\normalsize\thepage}\hfill
      \makebox[0pt][r]{\parbox{0.4\hsize}{%
        \raggedleft\ifx\undefined\dccp@titlefoot@doi\else\dccp@titlefoot@doi\fi
      }}%
    \end{minipage}%
  }%
  \let\@evenfoot=\@oddfoot
  \let\TitleFoot=\@oddfoot
}
%
% We set the normal page style to \textsf{title} here so that |\TitleHead| and
% |\TitleFoot| are defined, but we will override it with the \textsf{dccpaper} 
% page style later.
%
\pagestyle{title}
%
% The first page should use the \textsf{title} page style, however.
%
\AtBeginDocument{\thispagestyle{title}}

%
% Here are the normal headers and footers (i.e.\ the \textsf{dccpaper} page 
% style). We save them to |\NormalHead| and |\NormalFoot|, again so we can 
% measure them.
%
\def\ps@dccpaper{%
  \def\@oddhead{%
    \begin{minipage}{\textwidth}\frenchspacing
      {%
        \fontsize{9pt}{11pt}\selectfont
        \ifx\undefined\dccp@normhead@doi\else\dccp@normhead@doi\fi
      }\hfill
      {\MainAuthor}\space\space\space
      \textcolor{struct}{\textbar}\space\space\space
      \thepage\par
      \vskip6pt\color{struct}{\hrule height 1bp}\par
    \end{minipage}
  }%
  \def\@evenhead{%
    \begin{minipage}{\textwidth}
      \thepage\space\space\space
      \textcolor{struct}{\textbar}\space\space\space
      {\HeadTitle}\hfill
      {%
        \fontsize{9pt}{11pt}\selectfont
        \ifx\undefined\dccp@normhead@doi\else\dccp@normhead@doi\fi
      }\par
      \vskip6pt\color{struct}{\hrule height 1bp}\par
    \end{minipage}
  }%
  \let\NormalHead=\@oddhead
  \def\@oddfoot{\begin{minipage}[b]{\textwidth}
    \centering\bfseries\normalsize\color{struct}
    \ifx\dccp@type\dccp@editorial
      \dccp@publ@long
    \else
      \dccp@publ@short\space\space\textbar\space\space\emph{\dccp@type}%
    \fi
    \par
  \end{minipage}}%
  \let\@evenfoot=\@oddfoot
  \let\NormalFoot=\@oddfoot
}
\pagestyle{dccpaper}

%
% We need to wait until the author has supplied the necessary information before 
% we can do our measuring and set the remainder of the geometry, so we do it at 
% the end of the preamble. First we put our saved macros into boxes we can 
% measure (i.e.\ |\dccp@firstpagehead|, |\dccp@firstpagefoot|, 
% |\dccp@restpagehead|, |\dccp@restpagefoot|).
%
\AtEndPreamble{
  \newsavebox{\dccp@firstpagehead}
  \sbox\dccp@firstpagehead{\normalfont\TitleHead}
  \newsavebox{\dccp@firstpagefoot}
  \sbox\dccp@firstpagefoot{\normalfont
    \def\email#1{#1}\def\url#1{#1}\def\href#1#2{#2}\TitleFoot}
  \newsavebox{\dccp@restpagehead}
  \sbox\dccp@restpagehead{\normalfont\NormalHead}
  \newsavebox{\dccp@restpagefoot}
  \sbox\dccp@restpagefoot{\normalfont\NormalFoot}
%
% We can now set the geometry of the title page\dots
%
  \setlength{\headheight}{\ht\dccp@firstpagehead + \dp\dccp@firstpagehead}
  \setlength{\footskip}{%
    2\baselineskip + \ht\dccp@firstpagefoot + \dp\dccp@firstpagefoot
  }
  \setlength{\textheight}{%
    \paperheight
    - 30mm % 15mm top and bottom
    - \headheight
    - \headsep
    - \footskip
  }
%
% {\dots}and provide a macro that will reset the geometry for the remaining 
% pages.
%
  \def\dccp@resetgeometry{%
    \setlength{\headheight}{\ht\dccp@restpagehead + \dp\dccp@restpagehead}
    \global\headheight=\headheight
    \setlength{\footskip}{%
      2\baselineskip + \ht\dccp@restpagefoot
    }
    \global\footskip=\footskip
    \setlength{\textheight}{%
      \paperheight
      - 30mm % 15mm top and bottom
      - \headheight
      - \headsep
      - \footskip
    }
    \FixTextHeight
    \global\textheight=\textheight
  }
}

%
% The |\maketitle| command is redefined to the correct formatting. At the end it
% sets a hook that will reset the geometry when the first page is shipped out,
% i.e.\ with effect from the second page. It is here rather than at the end of
% the abstract in case the abstract itself spills over to the second page.
%
\RequirePackage{atbegshi}
\renewcommand{\maketitle}{%
  \null\nobreak\vspace*{-0.528\baselineskip}%
  \begingroup
    \centering
    {\Large\thetitle\par}
    \vspace{0.7\baselineskip}
    \AuthorBlock\par
    \vspace{1.7\baselineskip}
  \endgroup
  \AtBeginShipoutNext{\dccp@resetgeometry}%
}

%
% The \textsf{abstract} environment is redefined in terms of an environment 
% \textsf{widequote}, which mimics the \textsf{quote} environment, but is a bit 
% wider. We also provide a hook, |\afterabstract|, so that if some annotation 
% needs to be appended to the title page after the abstract, we can do that.
%
\newenvironment{widequote}{%
  \list{}{%
    \setlength{\rightmargin}{2\parindent}%
    \setlength{\leftmargin}{2\parindent}%
  }%
  \flushleftright\item[]%
}{%
    \endlist
}
\def\afterabstract{}
\renewenvironment{abstract}{%
  \vskip1em%
  \begin{center}%
    {\bfseries\abstractname\vspace{-.5em}\vspace{\z@}}%
  \end{center}%
  \widequote\footnotesize
}{%
  \endwidequote\afterabstract\newpage
}

%
% We use the \textsf{titlesec} package to give headings the correct formatting.
% The settings below try to space out headings so they occupy an integer number
% of normal lines (an attempt at grid typesetting). They are a little 
% complicated because we want it to work even if the heading appears at the top 
% of the page.
%
\RequirePackage{titlesec}
\titlespacing*{\section}{0pt}{0pt}{\baselineskip}
\titlespacing*{\subsection}{0pt}{0pt}{0.6\baselineskip}
\titlespacing{\subsubsection}{\parindent}{\baselineskip}{0pt}
\titlespacing{\paragraph}{\parindent}{\baselineskip}{0pt}
\titlespacing{\subparagraph}{\parindent}{\baselineskip}{0pt}
%
% An unfortunate side effect of spacing headings like this is that if a 
% |\subsection| immediately follows a |\section| it forms an unsightly gap. To
% remedy this, we count how many paragraphs there have been since the last
% |\section|. Note that as we do not normally number the sections, an automatic
% reset of the |sectionpars| counter within the |section| counter won't work.
%
\newcounter{sectionpars}
\let\dccp@old@ep\everypar
\newtoks\everypar
\dccp@old@ep{\the\everypar\stepcounter{sectionpars}} 
%
% We need to manually reset |sectionpars| when |\section| is called. Also,
% the normal font size is 12pt/14.5pt, while |\Large| is 17pt/22pt;
% so the |\Large| line height = 1.5172 $\times$ normal line height. Nevertheless
% it seems to work better if we let the heading eat 0.528|\baselineskip| into 
% the 2|\baselineskip| of padding above it.
%
\titleformat{\section}
  [block]
  {%
    \vspace{2\baselineskip}%
    \nobreak
    \vspace*{-0.528\baselineskip}%
    \setcounter{sectionpars}{0}%
    \filcenter\normalfont\Large\bfseries
  }
  {\thesection}
  {1em}
  {}
%
% The others use a |\normalsize| font so that makes life easier. The format
% for |\subsection| command includes conditional spacing: if the |sectionpars| 
% counter equals 2, this means the heading immediately follows a |\section|, so 
% less white space is needed.
%
\titleformat{\subsection}
  {%
    \ifnum\thesectionpars>2%
      \vspace{2\baselineskip}%
    \else
      \vspace{\baselineskip}%
    \fi\nobreak
    \vspace*{-0.6\baselineskip}%
    \normalfont\normalsize\bfseries
  }
  {\thesubsection}
  {1em}
  {}
\titleformat{\subsubsection}
  [block]
  {\normalfont\normalsize\bfseries}
  {\thesubsubsection}
  {1em}
  {}
\titleformat{\paragraph}
  [block]
  {\normalfont\normalsize\bfseries\itshape}
  {\thesubsubsection}
  {1em}
  {}
\titleformat{\subparagraph}
  [block]
  {\normalfont\normalsize\itshape}
  {\thesubsubsection}
  {1em}
  {}
%
% DCC papers do not typically number their sections.
%
\setcounter{secnumdepth}{0}

%
% To help with the display of tables we load the \textsf{array} and 
% \textsf{booktabs} packages. As we don't like lines between rows in the table
% body, we stretch them out a bit so that white space does the job instead.
%
\RequirePackage{array,booktabs}
\renewcommand{\arraystretch}{1.25}

%
% We use the \textsf{caption} package to give captions the right format.
%
\RequirePackage
  [ format=hang
  , labelsep=period
  , font=small
  , labelfont=bf
  , figureposition=bottom
  , tableposition=top
  ]{caption}

%
% Footnotes should be set right up against the left margin. They should be
% set hung and in the same half-ragged style as the main text. They should also,
% for neatness, be at the bottom of the page regardless of how short it is. The
% \textsf{footmisc} package helps here.
%
\RequirePackage[hang,bottom]{footmisc}
\settowidth{\footnotemargin}{\footnotesize\textsuperscript{99}\space}
\renewcommand{\footnotelayout}{\raggedyright}
%
% Also, if multiple footnotes are set at once, the markers should be separated
% with superscript commas. The \textsf{footmisc} package should help here but
% its solution is clobbered by \textsf{hyperref}. So after a footnote is set,
% we check to see if the next token is also a footnote, and if so, slip a comma
% in before it.\footnote{This solution was provided at 
% \url{http://tex.stackexchange.com/q/40072}} This tweak needs to be done late,
% |\AtBeginDocument|. Note that the \textsf{newtx} superior figures are a bit
% lower than normal superscript text.
%
\AtBeginDocument{
  \let\dccp@footnote\footnote
  \def\dccp@next@token{\relax}%
  \def\dccp@supercomma{\textsuperscript{,}}%
  \IfFileExists{newtxtext.sty}%
    {\def\dccp@supercomma{\raisebox{-0.2ex}{\textsuperscript{,}}}}%
    {}

  \newcommand\dccp@check@for@footnote{%
    \ifx\footnote\dccp@next@token
      \dccp@supercomma
    \fi
  }

  \renewcommand\footnote[1]{%
    \dccp@footnote{#1}%
    \futurelet\dccp@next@token\dccp@check@for@footnote
  }
}

%
% By default lists are quite loose. These settings help to tighten them.
%
\topsep = \z@
\partopsep = \z@
\appto{\enumerate}{\itemsep = 0.5ex plus 0.25ex minus 0.25ex}
\appto{\itemize}{\itemsep = 0.5ex plus 0.25ex minus 0.25ex}

%
% A DCC paper should either be using \textsf{biblatex} or \textsf{apacite} for
% references.
%
% If \textsf{biblatex} is used, we need to ensure that the reference list
% heading is a normal section rather than a starred one so it appears in the 
% PDF bookmarks.
%
\AtBeginDocument{
  \@ifpackageloaded{biblatex}{%
    \defbibheading{bibliography}[\refname]{\section{#1}}%
%
% We also move the ‘doi:’ portion of a DOI inside the hyperlink. 
%
    \DeclareFieldFormat{doi}{%
      \ifhyperref{%
        \href{http://dx.doi.org/#1}{\nolinkurl{doi:#1}}%
      }{%
        \nolinkurl{doi:#1}%
      }%
    }
  }{%
%
% If \textsf{apacite} is used, there are a few other adaptations we need to
% make.
%
    \@ifpackageloaded{apacite}{%
%
% With \textsf{hyperref} loaded, \textsf{apacite} makes the whole of a citation
% a link to the reference list item. We patch |\@ifauthorsunequalc@de| so only
% the year portion gets linked.
%
      \def\@ifauthorsunequalc@de#1{%
        \if@F@cite
          \@F@citefalse
        \else
          \if@Y@cite
              {\@BAY}%
          \fi
          {\@BBC}%
        \fi
        \edef\@cite@undefined{?}%
        \def\BBA{\@BBA}%
        \if@A@cite
          %%\hyper@natlinkstart{#1}% We remove this line...
          {\csname b@\@citeb\APAC@extra@b@citeb\endcsname}%
          %%\hyper@natlinkend% ...and this one.
          \if@Y@cite
              {\@BBAY}%
          \fi
        \fi
        \if@Y@cite
          \hyper@natlinkstart{#1}%
          {\csname Y@\@citeb\APAC@extra@b@citeb\endcsname}%
          \hyper@natlinkend
        \fi
        \let\BBA\relax
      }
%
% The Spanish language support file defines a different version of
% |\@ifauthorsunequalc@de|, which might override the patch we have just
% introduced. So we employ the same test that \textsf{apacite} uses when
% deciding whether to load that file; if successful, we patch the Spanish
% version. Note that as \textsf{apacite} loads language support files
% |\AtBeginDocument|, we have to do our thing after that, |\AfterEndPreamble|.
%
% (Note that as we set the language to British English earlier, this should
% never be needed, but we try to be resilient to tinkering!)
%
      \AfterEndPreamble{%
        \@ifundefined{iflanguage}{%
          \relax
        }{%
          \edef\APAC@tmp{nohyphenation}%
          \ifx\languagename\APAC@tmp
          \else
            \edef\APAC@tmp{spanish}%
            \ifx\languagename\APAC@tmp
              \def\@ifauthorsunequalc@de#1{%
                \if@F@cite
                  \@F@citefalse
                \else
                  \if@Y@cite
                      {\@BAY}%
                  \fi
                  {\@BBC}%
                \fi
                \edef\@cite@undefined{?}%
                \def\BBA{\@BBA}%
                \@ifundefined{spanishe@\@citeb\APAC@extra@b@citeb}%
                  {}% skip
                  {{% Use `e' instead of `y' in Spanish
                  \global\let\oldBBA\BBA
                  \global\def\BBA{e\global\let\BBA\oldBBA}%
                  }}%
                \if@A@cite
                  %%\hyper@natlinkstart{#1}% We remove this line...
                  {\csname b@\@citeb\APAC@extra@b@citeb\endcsname}%
                  %%\hyper@natlinkend% ...and this one.
                  \if@Y@cite
                      {\@BBAY}%
                  \fi
                \fi
                \if@Y@cite
                  \hyper@natlinkstart{#1}%
                  {\csname Y@\@citeb\APAC@extra@b@citeb\endcsname}%
                  \hyper@natlinkend
                \fi
                \let\BBA\relax
              }%
            \fi
          \fi
        }%
%
% Another thing \textsf{apacite} does |\AtBeginDocument| is set the URL style
% to monospaced. So we reset it back to normal roman type |\AfterEndPreamble|.
%
        \urlstyle{APACrm}
       }%
%
% We pre-empt \textsf{apacite}'s |\providecommand| of |\doi| with our own
% definition that includes the `doi' URI scheme label in the link, remembering
% to remove the one inserted by |\doiprefix|.
%
      \newcommand{\doi}[1]{\href{http://dx.doi.org/#1}{\nolinkurl{doi:#1}}}%
      \renewcommand{\doiprefix}{\unskip}%
    }{}%
  }%
%
% Both \textsf{biblatex} and \textsf{apacite} use |\bibitemsep| for the space
% between bibliography items. Just in case they haven't been loaded, though, we
% protect our setting of that length with an |\ifx| test.
%
  \ifx\undefined\bibitemsep
  \else
    \setlength{\bibitemsep}{1em plus 1ex minus 1ex}%
  \fi
}
%
% As mentioned above, if \textsf{apacite} is used, we can use a package option
% to ensure that the reference list heading appears in the PDF bookmarks.
%
\PassOptionsToPackage{numberedbib}{apacite}

%
% We, of course, use \textsf{hyperref} for enhancing the PDF with working links,
% bookmarks, metadata, etc.
%
\usepackage
  [ colorlinks=true
  , linkcolor=black
  , anchorcolor=black
  , citecolor=links
  , filecolor=black
  , menucolor=black
  , runcolor=black
  , urlcolor=links
  ]{hyperref}
%
% Links should be in roman type, not monospaced.
%
\urlstyle{rm}
%
% We provide an |\email| command for displaying the email address of the 
% corresponding author.
%
\newcommand*{\email}[1]{\href{mailto:#1}{#1}}
%
% Once the user has had a chance to provide the metadata, we can add it to the
% PDF metadata.
%
\AtBeginDocument{%
  \hypersetup
    { pdftitle={\thetitle}
    , pdfauthor={\dccp@author}
    , pdfsubject={\dccp@subject}
    }
%
% The APA has its own style for line breaks in URLs. The \textsf{apacite} 
% package provides the code for this, but in case \textsf{biblatex} is used
% instead, we repeat the settings (from 2013/07/21 v6.03) here.
%
  \@ifundefined{Url@force@Tilde}{\def\Url@force@Tilde{\relax}}{}%
  \def\url@apa@dot{\mathchar"2E }%
  \def\url@apa@comma{\mathchar"2C }%
  \def\url@apa@questionmark{\mathchar"3F }%
  \def\url@apa@exclamation{\mathchar"21 }%
  \def\url@apa@hyphen{\mathchar"2D }%
  \def\url@apa@underscore{\_}%
  \def\UrlBreaks{\do\@\do\\\do\|\do\;\do\>\do\]\do\)\do\'\do+\do\=\do\#}%
  \def\UrlBigBreaks{\do\/\do\:\do@url@hyp}%
  \def\UrlNoBreaks{\do\(\do\[\do\{\do\<}% \)}
  \def\UrlOrds{\do\*\do\~\do\'\do\"}%
  \def\UrlSpecials{%
    \do\.{\mathbin{}\url@apa@dot }%
    \do\,{\mathbin{}\url@apa@comma }%
    \do\-{\mathbin{}\url@apa@hyphen }%
    \do\?{\mathbin{}\url@apa@questionmark }%
    \do\!{\mathbin{}\url@apa@exclamation }%
    \do\_{\mathbin{}\url@apa@underscore }%
    \do\ {\Url@space}\do\%{\Url@percent}\do\^^M{\Url@space}%
    \Url@force@Tilde}%
  \def\Url@OTnonTT{\do\<{\langle}\do\>{\mathbin{\rangle}}\do
    \_{\mathbin{}\_}\do\|{\mid}\do\{{\lbrace}\do\}{\mathbin{\rbrace}}\do
    \\{\mathbin{\backslash}}\UrlTildeSpecial}
}

%
% We now embed the Creative Commons licence information in the PDF using an XMP
% packet. To do this, we employ the same technique as Scott Pakin's 
% \textsf{hyperxmp} (2014/01/02 v2.4). In order to avoid avoid a bug whereby
% Adobe Acrobat confuses the XMP author information and the regular author 
% information, though, we \emph{only} embed the licence information. 
%
% We need to make sure that any characters to appear verbatim in the XMP packet
% are treated as ordinary characters and not active ones. The likely active
% characters are symbols and punctuation, so should be treated as `other'
% (category 12).
%
\begingroup
\catcode`\"=12 
\catcode`\&=12 
\catcode`\#=12
\catcode`\<=12
\catcode`\>=12
\catcode`\_=12
%
% We construct the XMP packet as the document begins.
%
\AtBeginDocument{%
%
% For convenience we define |\sp| to be a level of indent, translating to three
% spaces.
%
  \def\sp{\space\space\space}
%
% The text of the XMP packet is recorded in |\cc@xmp@packet|. We use |^^J| to 
% break lines.
%
  \long\gdef\cc@xmp@packet{%
<?xpacket begin='' id=''?>^^J%
<x:xmpmeta xmlns:x='adobe:ns:meta/'>^^J%
<rdf:RDF xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#'>^^J%
\sp<rdf:Description rdf:about=''^^J%
\sp\sp xmlns:xapRights='http://ns.adobe.com/xap/1.0/rights/'>^^J%
\sp\sp<xapRights:Marked>True</xapRights:Marked>^^J%
\sp</rdf:Description>^^J%
\sp<rdf:Description rdf:about=''^^J%
\sp\sp xmlns:dc='http://purl.org/dc/elements/1.1/'>^^J%
\sp\sp<dc:rights>^^J%
\sp\sp\sp<rdf:Alt>^^J%
\sp\sp\sp\sp<rdf:li xml:lang='x-default'>This work is licensed under a Creative Commons Attribution 4.0 International Licence.</rdf:li>^^J%
\sp\sp\sp</rdf:Alt>^^J%
\sp\sp</dc:rights>^^J%
\sp</rdf:Description>^^J%
\sp<rdf:Description rdf:about=''^^J%
\sp\sp xmlns:cc='http://creativecommons.org/ns#'>^^J%
\sp\sp<cc:license rdf:resource='http://creativecommons.org/licenses/by/4.0/'/>^^J%
\sp</rdf:Description>^^J%
</rdf:RDF>^^J%
</x:xmpmeta>^^J%
<?xpacket end='r'?>^^J%
  }%
}
\endgroup
%
% Different workflows require the XMP packet to be embedded in different ways.
%
% Pdf\TeX\ can inject objects into PDFs natively.
%
\newcommand*{\ccxmp@embed@packet@pdftex}{%
  \bgroup
    \pdfcompresslevel=0
    \immediate\pdfobj stream attr {%
      /Type /Metadata
      /Subtype /XML
    }{\cc@xmp@packet}%
    \pdfcatalog {/Metadata \the\pdflastobj\space 0 R}%
  \egroup
}
%
% The |\pdfmark| command defined by \textsf{hyperref} is respected by tools such
% as Dvipdf, Dvips, Dvipsone, etc.
%
\newcommand*{\ccxmp@embed@packet@pdfmark}{%
  \pdfmark{%
    pdfmark=/NamespacePush
  }%
  \pdfmark{%
    pdfmark=/OBJ,
    Raw={/_objdef \string{ccxmp@packet\string} /type /stream}%
  }%
  \pdfmark{%
    pdfmark=/PUT,
    Raw={\string{ccxmp@packet\string}
      2 dict begin
        /Type /Metadata def
        /Subtype /XML def
        currentdict
      end
    }%
  }%
  \pdfmark{%
    pdfmark=/PUT,
    Raw={\string{ccxmp@packet\string} (\cc@xmp@packet)}%
  }%
  \pdfmark{%
    pdfmark=/Metadata,
    Raw={\string{Catalog\string} \string{ccxmp@packet\string}}%
  }%
  \pdfmark{%
    pdfmark=/NamespacePop
  }%
}
%
% Dvipdfm has its own |\special| command for inserting PDF objects, but
% it is a bit basic and requires advance knowledge of how long (in characters)
% the object is.
%
% The |\ccxmp@count@spaces| macro counts the number of spaces in its parameter 
% through a process of iteration, adding this figure to |\@tempcnta|.
%
\def\ccxmp@count@spaces#1 {%
  \def\ccxmp@one@token{#1}%
  \ifx\ccxmp@one@token\@empty
    \advance\@tempcnta by -1
  \else
    \advance\@tempcnta by 1
    \expandafter\ccxmp@count@spaces
  \fi
}
%
% The |\ccxmp@count@non@spaces| command counts the number of non-spaces in its 
% argument through a process of iteration, adding this figure to |\@tempcnta|.
%
\newcommand*{\ccxmp@count@non@spaces}[1]{%
  \def\ccxmp@one@token{#1}%
  \ifx\ccxmp@one@token\@empty
  \else
    \advance\@tempcnta by 1
    \expandafter\ccxmp@count@non@spaces
  \fi
}
%
% The |\ccxmp@string@len| command sets |\@tempcnta| to the number of characters 
% (spaces + non-spaces) in its argument.
%
\newcommand*{\ccxmp@string@len}[1]{%
  \@tempcnta=0
  \expandafter\ccxmp@count@spaces#1 {} %
  \expandafter\ccxmp@count@non@spaces#1{}%
}
%
% So now, finally, is the command for embedding the packet using Dvipdfm.
%
\newcommand*{\ccxmp@embed@packet@dvipdfm}{%
  \ccxmp@string@len{\cc@xmp@packet}%
  \special{pdf: object @ccxmp@packet
    <<
      /Type /Metadata
      /Subtype /XML
      /Length \the\@tempcnta
    >>
    stream^^J\cc@xmp@packet endstream%
  }%
  \special{pdf: docview
    <<
      /Metadata @ccxmp@packet
    >>
  }%
}
%
% \XeTeX\ creates PDFs with Xdvipdfmx, which supports a simpler |\special| for
% inserting objects that does not require us to count characters.
%
\newcommand*{\ccxmp@embed@packet@xetex}{%
  \special{pdf:stream @ccxmp@packet (\cc@xmp@packet)
    <<
      /Type /Metadata
      /Subtype /XML
    >>
  }%
  \special{pdf:put @catalog
    <<
      /Metadata @ccxmp@packet
    >>
  }%
}
%
% We rely on \textsf{hyperref} to tell us how the PDF will be generated (after
% all, it may not be done in the current pass) and use the respective technique
% to embed the XMP packet.
%
\AtBeginDocument{%
  \begingroup
  \def\ccxmp@driver{hpdftex}%
  \ifx\ccxmp@driver\Hy@driver
    \ccxmp@embed@packet@pdftex
  \else
    \def\ccxmp@driver{hdvipdfm}%
    \ifx\ccxmp@driver\Hy@driver
      \ccxmp@embed@packet@dvipdfm
    \else
      \def\ccxmp@driver{hxetex}%
      \ifx\ccxmp@driver\Hy@driver
        \ccxmp@embed@packet@xetex
      \else
        \@ifundefined{pdfmark}{}{%
          \ccxmp@embed@packet@pdfmark
        }%
      \fi
    \fi
  \fi
  \endgroup
}
%LITERATE
%</base>
%<*biblatex|apacite>
@book{apa6ed,
  author = {{American Psychological Association}},
  shortauthor = {{APA}},
  publisher = {Author},
%<biblatex>  date = {2010},
%<apacite>  year = {2010},
  title = {Publication manual of the {American} {Psychological} {Association}},
  edition = {6},
%<biblatex>  location = {Washington, DC}
%<apacite>  address = {Washington, DC}
}

@book{borgman2007sda,
  author = {Borgman, C. L.},
%<biblatex>  date = {2007},
%<apacite>  year = {2007},
%<biblatex>  title = {Scholarship in the digital age},
%<biblatex>  subtitle = {Information, infrastructure, and the {Internet}},
%<apacite>  title = {Scholarship in the digital age: Information, infrastructure, and the {Internet}},
%<biblatex>  location = {Cambridge, MA},
%<apacite>  address = {Cambridge, MA},
  publisher = {MIT Press}
}

@inbook{borgman.etal2006bdl,
  author = {Borgman, C. L. and Wallis, J. C. and Enyedy, N.},
%<biblatex>  date = {2006},
%<apacite>  year = {2006},
%<biblatex>  title = {Building digital libraries for scientific data},
%<biblatex>  subtitle = {An exploratory study of data practices in habitat ecology},
%<apacite>  title = {Building digital libraries for scientific data: An exploratory study of data practices in habitat ecology},
  editor = {J. Gonzalo and C. Thanos and M. F. Verdejo and R. C. Carrasco},
%<biblatex>  booktitle = {{Lecture} {Notes} in {Computer} {Science}},
%<biblatex>  booksubtitle = {Vol. 4172. {Research} and {Advanced} {Technology} for {Digital} {Libraries}},
%<apacite>  booktitle = {{Lecture} {Notes} in {Computer} {Science:} {Vol.} 4172. {Research} and {Advanced} {Technology} for {Digital} {Libraries}},
  pages = {170--183},
  doi = {10.1007/11863878_15}
}

%<biblatex>@report{ccsds2012oais,
%<apacite>@techreport{ccsds2012oais,
  author = {{Consultative Committee for Space Data Systems}},
  shortauthor = {{CCSDS}},
%<biblatex>  date = {2012},
%<apacite>  year = {2012},
  title = {Reference model for an {Open} {Archival} {Information} {System} {(OAIS)}},
  type = {Magenta Book},
  number = {CCSDS 650.0-M-2},
  url = {http://public.ccsds.org/publications/archive/650x0m2.pdf}
}

%<biblatex>@report{dcc2005dcp,
%<apacite>@techreport{dcc2005dcp,
  author = {{Digital Curation Centre}},
%<biblatex>  date = {2005},
%<apacite>  year = {2005},
%<biblatex>  title = {Digital curation and preservation},
%<biblatex>  subtitle = {Defining the research agenda for the next decade},
%<apacite>  title = {Digital curation and preservation: Defining the research agenda for the next decade},
%<apacite>  type = {\bibnotype},
%<biblatex>  note = {Report of the Warwick Workshop, November 7–8, 2005},
%<apacite>  howpublished = {Report of the Warwick Workshop, November 7–8, 2005},
  url = {http://www.dcc.ac.uk/webfm_send/346}
}

@article{esanu.etal2004sar,
  author = {Esanu, J. and Davidson, J. and Ross, S. and Anderson, W.},
%<biblatex>  date = {2004},
%<apacite>  year = {2004},
%<biblatex>  title = {Selection, appraisal, and retention of digital scientific data},
%<biblatex>  subtitle = {Highlights of an {ERPANET\slash CODATA} workshop},
%<apacite>  title = {Selection, appraisal, and retention of digital scientific data: Highlights of an {ERPANET\slash CODATA} workshop},
%<biblatex>  journaltitle = {Data Science Journal},
%<apacite>  journal = {Data Science Journal},
  volume = {3},
  pages = {227--232},
  url = {http://www.jstage.jst.go.jp/browse/dsj}
}

@article{mazairac.beetzIPboq,
  author = {Mazairac, W. and Beetz, J.},
%<biblatex>  pubstate = {inpress},
%<apacite>  year = {\BIP},
%<biblatex>  title = {{BIMQL}},
%<biblatex>  subtitle = {An Open Query Language for Building Information Models},
%<apacite>  title = {{BIMQL}: An Open Query Language for Building Information Models},
%<biblatex>  journaltitle = {Advanced Engineering Informatics},
%<apacite>  journal = {Advanced Engineering Informatics},
  doi = {10.1016/j.aei.2013.06.001}
}

%<biblatex>@report{nsf2003rse,
%<apacite>@techreport{nsf2003rse,
  author = {{National Science Foundation, Blue-Ribbon Advisory Panel on Cyberinfrastructure}},
%<biblatex>  date = {2003},
%<apacite>  year = {2003},
  title = {Revolutionizing science and engineering through cyberinfrastructure},
%<apacite>  type = {\bibnotype},
  url = {http://www.nsf.gov/publications/pub_summ.jsp?ods_key=cise051203}
}

@article{rinaldo.etal2011rsc,
  author = {Rinaldo, C. and Warnement, J. and Baione, T. and Kalfatovic, M. R. and Fraser, S.},
%<biblatex>  date = {2011-07},
%<apacite>  year = {2011},
%<apacite>  month = jul,
  title = {Retooling special collections digitisation in the age of mass scanning},
%<biblatex>  journaltitle = {Ariadne},
%<apacite>  journal = {Ariadne},
  volume = {67},
  url = {http://www.ariadne.ac.uk/issue67/rinaldo-et-al/}
}

@unpublished{santini2004sas,
  author = {Santini, M.},
%<biblatex>  date = {2004},
%<apacite>  year = {2004},
  title = {A shallow approach to syntactic feature extraction for genre classification},
  howpublished = {Paper presented at the Seventh Annual Colloquium for the UK Special Interest Group for Computational Linguistics, Birmingham, UK},
  url = {ftp://ftp.itri.bton.ac.uk/reports/ITRI-04-02.pdf}
}

%<biblatex>@report{santini2004saa,
%<apacite>@techreport{santini2004saa,
  author = {Santini, M.},
%<biblatex>  date = {2004},
%<apacite>  year = {2004},
  title = {State-of-the-art on automatic genre identification},
  type = {Technical Report},
  number = {ITRI-04-03},
  institution = {Information Technology Research Institute},
  url = {ftp://ftp.itri.bton.ac.uk/reports/ITRI-04-03.pdf}
}

@article{smith.etal2003das,
  author = {Smith, M. and Barton, M. and Bass, M. and Branschofsky, M. and McClellan, G. and Stuve, D. and Walker, J. H.},
%<biblatex>  date = {2003},
%<apacite>  year = {2003},
%<biblatex>  title = {{DSpace}},
%<biblatex>  subtitle = {An open source dynamic digital repository},
%<apacite>  title = {{DSpace}: An open source dynamic digital repository},
%<biblatex>  journaltitle = {D-Lib Magazine},
%<apacite>  journal = {D-Lib Magazine},
  volume = {9},
  number = {1},
  doi = {10.1045/january2003-smith}
}

%<biblatex>@data{waterton.etal2013ual,
%<apacite>@misc{waterton.etal2013ual,
  author = {Waterton, C. and Watson, N. and Norton, L.},
  title = {Understanding and Acting in {Loweswater}, 2007–2010},
%<biblatex>  entrysubtype = {Data set},
%<apacite>  type = {Data set},
%<biblatex>  date = {2013},
%<apacite>  year = {2013},
  publisher = {UK Data Archive},
%<biblatex>  location = {Colchester, UK},
%<apacite>  address = {Colchester, UK},
  doi = {10.5255/UKDA-SN-7359-1}
}

@book{witten.frank2005dmp,
  author = {Witten, I. H. and Frank, E.},
%<biblatex>  date = {2005},
%<apacite>  year = {2005},
%<biblatex>  title = {Data mining},
%<biblatex>  subtitle = {Practical machine learning tools and techniques},
%<apacite>  title = {Data mining: Practical machine learning tools and techniques},
  edition = {2},
%<biblatex>  location = {San Francisco, CA},
%<apacite>  address = {San Francisco, CA},
  publisher = {Morgan Kaufmann}
}
%</biblatex|apacite>
%<*internal>
\fi
\def\nameofplainTeX{plain}
\ifx\fmtname\nameofplainTeX\else
  \expandafter\begingroup
\fi
%</internal>
%<*install>
\input docstrip.tex
\keepsilent
\askforoverwritefalse
\preamble

----------------------------------------------------------------
The dccpaper bundle: Classes for submissions to IJDC and IDCC
Author:  Alex Ball
E-mail:  a.ball@ukoln.ac.uk
License: Released under the LaTeX Project Public License v1.3c or later
See:     http://www.latex-project.org/lppl.txt
----------------------------------------------------------------

\endpreamble
\postamble

Copyright (C) 2015 Digital Curation Centre, University of Edinburgh
<info@dcc.ac.uk>
\endpostamble

\usedir{tex/latex/dccpaper}
\generate{
  \file{ijdc-v9.cls}{\from{\jobname.dtx}{ijdc9}}
  \file{idcc.cls}{\from{\jobname.dtx}{idcc}}
  \file{dccpaper-base.tex}{\from{\jobname.dtx}{base}}
}
%</install>
%<install>\endbatchfile
%<*internal>
\usedir{source/latex/dccpaper}
\generate{
  \file{\jobname.ins}{\from{\jobname.dtx}{install}}
}
\nopreamble\nopostamble
\usedir{doc/latex/dccpaper}
\generate{
  \file{README.txt}{\from{\jobname.dtx}{readme}}
  \file{dccpaper-biblatex.bib}{\from{\jobname.dtx}{biblatex}}
  \file{dccpaper-apacite.bib}{\from{\jobname.dtx}{apacite}}
}
\ifx\fmtname\nameofplainTeX
  \expandafter\endbatchfile
\else
  \expandafter\endgroup
\fi
%</internal>
%<*driver>
\ProvidesFile{dccpaper.dtx}
    [\Version\ Classes for submissions to IJDC and IDCC]
\documentclass{ijdc-v9}

\title[The \textsf{dccpaper} bundle]{The \protect\textsf{dccpaper} bundle: Classes for submissions to IJDC and IDCC}

\author{Alex Ball}
\affil{Digital Curation Centre}
\correspondence{Alex Ball, UKOLN, University of Bath, Claverton Down, Bath BA2 7AY. Email: \email{a.ball@ukoln.ac.uk}}

\received{4 July 2013}
\revised{10 December 2013}
\accepted{1 January 2014}

\usepackage{dcolumn,csquotes}
\usepackage[utf8]{inputenc}

\usepackage[style=apa]{biblatex}
\addbibresource{dccpaper-biblatex.bib}
\DeclareLanguageMapping{british}{british-apa}

%%\usepackage{apacite}
%%\bibliographystyle{apacite}
%%\let\textcite=\citeA
%%\let\autocite=\cite

\usepackage{enumitem}
\usepackage{listings}
\lstloadlanguages{[LaTeX]TeX}
\lstset
  { columns=fullflexible
  , basicstyle=\ttfamily
  , language={[LaTeX]TeX}
  , texcsstyle=*\color{red!75!black}
  , moretexcs=
    { affil
    , conference
    , correspondence
    , submitted
    , received
    , revised
    , accepted
    , subno
    , volume
    , issue
    , maketitle
    , sisetup
    , toprule
    , cmidrule
    , midrule
    , bottomrule
    , DeclareLanguageMapping
    , printbibliography
    , addbibresource
    , subsection
    , subparagraph
    }
  , moredelim=**[s][\color{violet}]{[}{]}
  , moredelim=**[s][\color{blue!75!black}]{\{}{\}}
  , mathescape
  , escapechar=~
  }
\newcommand{\subtext}[1]{\ensuremath\langle\textit{\rmfamily#1}\rangle}

\usepackage[iso,british]{isodate}
\usepackage{readprov}

% For typesetting the implementation
\usepackage{metalogo}
\usepackage{makedoc}[2012/04/03]
\usepackage{niceverb}[2012/08/27]
\renewcommand{\SetOffInlineCmdBox}{\textcolor{red!75!black}}
\renewcommand*{\TreatAsCode}[1]{%
  \ifPackageCode
  \else
    \WriteResult{\string\begin{lstlisting}[firstnumber=last]}%
    \PackageCodeTrue
  \fi
  \WriteResult{#1}%
}
\renewcommand*{\TreatAsComment}[1]{%
  \ifPackageCode
    \WriteResult{\string\end{lstlisting}}%
    \WriteResult{}
    \PackageCodeFalse
    \EveryComment
  \fi
  \WriteResult{#1}%
}
\makeatletter
\PushCatMakeLetter\_
\renewcommand*{\make_doc_arg}[1]{%
  \makedoc_maybe_autocorr
  \ifnum\value{lstnumber}>\z@
    \WriteResult{\string\begin{lstlisting}[firstnumber=1]}%
    \PackageCodeTrue
  \else
    \PackageCodeFalse
  \fi
  \ProcessFileWith{#1}{%
    \CountInputLines
    \makedoc_line_body
    \process_line_message
  }%
  \ifPackageCode
    \WriteResult{\string\end{lstlisting}}
    \PackageCodeFalse
  \fi
}
\PopLetterCat\_
\makeatother

\begin{document}
\noNiceVerb
\maketitle

\begin{abstract}
This is the documentation for the \textsf{dccpaper} bundle, consisting of the following classes:
\begin{itemize}
\item\textsf{ijdc-v9}, which corresponds to the template used by the International Journal of Digital Curation, beginning with volume 9. 
\item\textsf{idcc}, which corresponds to the template used for the International Digital Curation Conference, beginning with IDCC15.
\end{itemize}

The version to which it relates is \UseVersionOf{dccpaper-base.tex}, last revised\printdateTeX{\UseDateOf{dccpaper-base.tex}}.

The code for this bundle is maintained at \url{https://github.com/DigitalCurationCentre/dccpaper}.

Versions of the templates are also available that target Microsoft Word and LibreOffice\slash OpenOffice.org.

Please note that the DOI attached to this document is fake and should not be used for identification purposes.
\end{abstract}

\section{Introduction}

The \LaTeX\ class \textsf{ijdc-v9} produces camera-ready papers and articles suitable for inclusion in the International Journal of Digital Curation, with applicability from volume 9 onwards. The similar \textsf{idcc} class can be used for submissions to the International Digital Curation Conference, beginning with the 2015 conference. This document explains how to use these classes.

\section{Dependencies}

Certain aspects of the template design have been implemented using third-party packages, aside from those that are required parts of the \LaTeX\ system. Therefore you should ensure that you have these packages installed on your system before attempting to use the class.

\begin{itemize}
\item\textsf{atbegshi} is used for switching geometry between pages.
\item Tables in your document must be formatted according to the design principles promoted and supported by the \textsf{booktabs} package.
\item\textsf{caption} is used to format the figure and table captions.
\item\textsf{etoolbox} is used behind the scenes for patching commands.
\item\textsf{footmisc} is used to format the footnotes.
\item\textsf{titlesec} is used to format the section headings.
\end{itemize}

In some cases the class prefers to use packages that are not part of the base installation (but are nevertheless commonly available in \TeX\ distributions), but will fall back to their base equivalents if necessary.

\begin{itemize}
\item
\textsf{newtx} will be used if available in place of \textsf{times}.
\item
\textsf{xcolor} will be used if available in place of \textsf{color}.
\end{itemize}

For referencing, you are encouraged to use either \textsf{biblatex} using the styles provided by \textsf{biblatex-apa} (preferred), or \textsf{apacite}.

\section{Loading the Classes}

\subsection{International Journal of Digital Curation}

The class is loaded in the usual way with 
\lstinline|\documentclass[$\subtext{options}$]{ijdc-v9}|.
The following options are available:

\begin{description}[font=\color{violet}\ttfamily]
\item[paper]
Use this for peer-reviewed papers.
\item[article]
Use this for general (non-peer-reviewed) articles if you like, but you do not have to as the class defaults to this state.
\item[editorial]
Use this for an editorial.
\end{description}

\subsection{International Digital Curation Conference}

The class is loaded in the usual way with
\lstinline|\documentclass[$\subtext{options}$]{idcc}|.
Two types of option are available. The first relates to the type of submission:
\begin{description}[font=\color{violet}\ttfamily]
\item[research]
Use this for full research papers.
\item[practice]
Use this for extended abstracts of practice papers, and full practice papers. The class defaults to this state, making this option even more optional than normal.
\item[data]
Use this for data paper abstracts and full data papers.
\item[poster]
Use this for poster abstracts.
\item[demo]
Use this for demonstration proposals.
\item[bof]
Use this for Birds of a Feather session abstracts.
\item[workshop]
Use this for workshop proposals.
\end{description}

The second type of option relates to the conference to which the submission will be made:
\begin{description}[font=\color{violet}\ttfamily]
\item[15]
Use this for the 2015 conference.
\item[16]
Use this for the 2016 conference.
\end{description}

\section{Preamble Commands}

The following commands should be given in the preamble to fill out the document metadata.

The following command should be used in all submissions.

\begin{description}
\item[]
\hskip-\labelsep
\lstinline|\title[$\subtext{short version}$]{$\subtext{full version}$}|
\hskip\labelsep
The long version of the title is shown on the cover page of the submission, while the short version appears in the (even page) headers.
\end{description}

The following commands should be given in general articles and IDCC submissions. They should \emph{not} be given in peer-reviewed IJDC papers until after the peer review process is complete.

\begin{description}
\item[]
\hskip-\labelsep
\lstinline|\author{$\subtext{name}$}|
\hskip\labelsep
The name of one author. Repeat the command for each additional author.

It is customary in IJDC and IDCC papers to group authors by institution. Within each institution, the authors are ordered by the level of contribution (or alphabetically where this is equal), and the institutional groups are ordered by the level of contribution of the first author in the group (or alphabetically by first author where this is equal). A different convention may be used if appropriate.

\item[]
\hskip-\labelsep
\lstinline|\affil{$\subtext{name}$}|
\hskip\labelsep
The affiliation (institution, company) of the immediately preceding author(s). This command may be repeated as necessary.

\item[]
\hskip-\labelsep
\lstinline|\correspondence{$\subtext{name, postal address.}$ Email: \email{$\subtext{email address}$}}|
\hskip\labelsep
Name, address and email address of the corresponding author. This information appears in the footer of the cover page.
\end{description}

If an IJDC submission is a reworked conference paper (that has not already been formally published), for reasons of transparency the name of the conference should be given.

\begin{description}
\item[]
\hskip-\labelsep
\lstinline|\conference{$\subtext{name of conference}$}|
\hskip\labelsep
The conference at which the earlier version of the paper was presented, e.g.\ ‘the 10th International Digital Curation Conference’.
\end{description}

For IDCC papers, authors are invited to record the date on which they made their submission.

\begin{description}
\item[]
\hskip-\labelsep
\lstinline|\submitted{$\subtext{date}$}|
\hskip\labelsep
The date on which the initial submission was made to the conference by the authors.
\end{description}

Some additional commands are used by the editorial team when preparing a submission for publication. Though authors would not normally need to use them, here they are for completeness.

\begin{description}
\item[]
\hskip-\labelsep
\lstinline|\received{$\subtext{date}$}|
\hskip\labelsep
The date on which the initial submission was received by the editorial team (IJDC papers only).

\item[]
\hskip-\labelsep
\lstinline|\revised{$\subtext{date}$}|
\hskip\labelsep
The date on which the latest revision was received by the editorial team.

\item[]
\hskip-\labelsep
\lstinline|\accepted{$\subtext{date}$}|
\hskip\labelsep
The date on which the submission was accepted for publication.

\item[]
\hskip-\labelsep
\lstinline|\subno{$\subtext{number}$}|
\hskip\labelsep
The submission number allocated by the IJDC Open Journal System.

\item[]
\hskip-\labelsep
\lstinline|\volume{$\subtext{number}$}|
\hskip\labelsep
The number of the IJDC volume in which the submission will be published.

\item[]
\hskip-\labelsep
\lstinline|\issue{$\subtext{number}$}|
\hskip\labelsep
The number of the IJDC issue in which the submission will be published.

\item[]
\hskip-\labelsep
\lstinline|\date{$\subtext{year}$}|
\hskip\labelsep
The year in which the submission will be published.
\end{description}

\section{Document Body}

When it comes to writing the body of the submission, the template should allow you to use the usual \LaTeX\ markup without much adaptation. So, for example, you would start as in Figure~\ref{fig:start-paper}.

\begin{figure}[ht]
\begin{lstlisting}[frame=single]
\begin{document}
\maketitle

\begin{abstract}
Text of the abstract\dots
\end{abstract}

\section{Introduction}

The text of the introduction starts here\dots
\end{lstlisting}
\caption{Sample code for the beginning of an IJDC submission or IDCC full paper.}
\label{fig:start-paper}
\end{figure}

Please note that if submitting an abstract or proposal to the IDCC instead of a full paper, you should \emph{not} use the \texttt{abstract} environment. Instead, start with a section headed `Abstract' as in Figure~\ref{fig:start-abstract}. Further guidance on how to write such submissions is given on the conference website.

\begin{figure}[ht]
\begin{lstlisting}[frame=single]
\begin{document}
\maketitle

\section{Abstract}

The text of the abstract or proposal starts here\dots
\end{lstlisting}
\caption{Sample code for the beginning of an IDCC abstract or proposal.}
\label{fig:start-abstract}
\end{figure}

IJDC and IDCC papers follow the formatting conventions specified by the \textcite{apa6ed}, with a few minor changes. There are some instances where this affects how you write your submission.

\subsection{Headings}

Five levels of heading are defined (\lstinline|\section| down to \lstinline|\subparagraph|) but most authors only need the first one or two levels. \lstinline|\section| and \lstinline|\subsection| headings should be written in title case, that is, with Each Significant Word Given an Initial Capital, while the remaining headers should be written in sentence case as if running text. Do not end your heading names with full stops\slash periods.

\subsection{Quotations}

Quotations should be put in a \texttt{quote} environment, wrapped in inverted commas, with the citation placed in parentheses at the end.

\begin{quote}
‘Cras porttitor dictum lacus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. In consectetuer, diam at volutpat elementum, libero lectus pulvinar sem.’ (Borgman, 2007)
\end{quote}

\subsection{Tables}

\begin{itemize}
\item
Table text should be in the \lstinline|\small| font size.
\item
Tables should not use vertical lines to separate columns, and ideally should not use horizontal lines to separate rows in the body of the table; white space and text alignment should be sufficient. The top and bottom rules should be drawn with \lstinline|\toprule| and \lstinline|\bottomrule| respectively, with other rules drawn with \lstinline|\midrule| or \lstinline|\cmidrule|. See the documentation of the \textsf{booktabs} package for more information.
\item
Text in the body of tables should normally be left-aligned. Numeric data should be aligned at the decimal point among itself but centred with respect to the heading; the \texttt{D} column type from the \textsf{dcolumn} package and the \texttt{S} column type from the \textsf{siunitx} package are particularly useful for this.
\item
Where decked (subdivided) headings are used, there should be a border beneath the upper-level heading (column spanner) indicating to which of the lower-level headings it applies.
\item
Empty cells can either be left blank or represented by an em dash. A blank cell indicates non-applicability, while an em dash signifies that the data was not collected or has been omitted.
\item
Captions should end in a full stop\slash period.
\end{itemize}

Table~\ref{tab:issues} demonstrates these features. The code used to produce the table is shown in Figure~\ref{fig:table} (note that the \textsf{dcolumn} package was loaded in the preamble).

\begin{table}[ht]
\caption{Papers and articles published in the IJDC in 2008 and 2009.}
\label{tab:issues}
\centering\small
\begin{tabular}{lD..{2.0}D..{2.0}D..{2.1}D..{2.1}}
\toprule
 & \multicolumn{2}{c}{Frequency} & \multicolumn{2}{c}{Percentage} \\
\cmidrule(lr){2-3}\cmidrule(l){4-5}
Issue
 & \multicolumn{1}{c}{Peer-reviewed} & \multicolumn{1}{c}{General}
 & \multicolumn{1}{c}{Peer-reviewed} & \multicolumn{1}{c}{General} \\
\midrule
3(1) &  9 &  7 & 56.3 & 43.8 \\
3(2) &  5 &  7 & 41.7 & 58.3 \\
4(1) & 10 &  4 & 71.4 & 28.6 \\
4(2) &  8 &  6 & 57.1 & 42.9 \\
4(3) &  3 & 15 & 16.7 & 83.3 \\
\bottomrule
\end{tabular}
\end{table}

\begin{figure}[h]
\begin{lstlisting}[frame=single]
\begin{table}
\caption{Papers and articles published in the IJDC in 2008 and 2009.}
\label{tab:issues}
\centering\small
\begin{tabular}{lD..{2.0}D..{2.0}D..{2.1}D..{2.1}}
\toprule
& \multicolumn{2}{c}{Frequency} & \multicolumn{2}{c}{Percentage} \\
\cmidrule(lr){2-3}\cmidrule(l){4-5}
Issue
& \multicolumn{1}{c}{Peer-reviewed} & \multicolumn{1}{c}{General}
& \multicolumn{1}{c}{Peer-reviewed} & \multicolumn{1}{c}{General} \\
\midrule
3(1) &  9 &  7 & 56.3 & 43.8 \\
3(2) &  5 &  7 & 41.7 & 58.3 \\
4(1) & 10 &  4 & 71.4 & 28.6 \\
4(2) &  8 &  6 & 57.1 & 42.9 \\
4(3) &  3 & 15 & 16.7 & 83.3 \\
\bottomrule
\end{tabular}
\end{table}
\end{lstlisting}
\caption{Code used to typeset Table~\ref{tab:issues}.}
\label{fig:table}
\end{figure}

Note the different relative positions of the table and figure captions.

\subsection{Reference List and Citations}

To use \textsf{biblatex} for your reference list, add the following to your preamble:
\begin{lstlisting}
\usepackage[style=apa]{biblatex}
\addbibresource{$\subtext{bib file}$.bib}
\DeclareLanguageMapping{british}{british-apa}
\end{lstlisting}
and include \lstinline|\printbibliography| at the end of the document.

To use \textsf{apacite} for your reference list, add the following to your preamble: 
\begin{lstlisting}
\usepackage{apacite}
\bibliographystyle{apacite}
\end{lstlisting}
and include \lstinline|\bibliography{$\subtext{bib file}$}| at the end of the document.

In-text citations are given parenthetically in author–date format. If author forms part of the narrative, as with \textcite{rinaldo.etal2011rsc}, only the date is added in parenthesis, otherwise both author and date are given \autocite{smith.etal2003das}. Where multiple citations are given at once, the order should be the same as in the reference list, i.e.\ alphabetically by author, with co-authored works coming after singly-authored works, then chronologically \autocite{borgman.etal2006bdl, dcc2005dcp, mazairac.beetzIPboq, santini2004sas, santini2004saa, smith.etal2003das, witten.frank2005dmp}. Please consult the documentation of the package you are using for how to achieve this.

Please do not cite entire websites through the reference list mechanism. Instead, provide the title of the website (in English) and the URL in a footnote.\footnote{Digital Curation Centre: \url{http://www.dcc.ac.uk/}} If the title of the website is not clear from the visible pages, the contents of the HTML title element may be used. Other explanatory notes, whether about the body text or cited items, should also be given as footnotes rather than as endnotes or reference list annotations.\footnote{This avoids unnecessary page turning or scrolling.}

Please provide digital object identifiers (DOIs) for referenced items where available.

The data underlying the results presented in the submission should be placed in an appropriate custodial environment and cited \autocite{waterton.etal2013ual}, with the reference placed in the reference list. The \textsf{biblatex-apa} package provides a \texttt{data} entry type which should be used for datasets; the \texttt{entrysubtype} value should be \enquote{\texttt{Data set}} or similar. If using \textsf{apacite}, use the \texttt{misc} entry type with a \texttt{type} value of \enquote{\texttt{Data set}} or similar.

\section{Acknowledgements}

Any acknowledgements should be placed in a section immediately before the references.\nocite{*}

\printbibliography
%%\bibliography{dccpaper-apacite.bib}

\newpage
\section{Appendix A: Change History}

\begin{description}
\item[v1.4.1] 2014-06-22\\
Fixed bug preventing compilation in DVI mode.
\item[v1.4] 2015-05-22\\
Added details of IDCC 2016. Improved whitespace handling. Fixed bug triggered by \texttt{demo} option. Fixed missing use of \lstinline|\Authfont|. Added missing DOI tweak for \textsf{biblatex-apa}.
\item[v1.3.2] 2015-01-21\\
Removed dependence on user supplying a title. Fixed bug triggered by numbered sections.
\item[v1.3.1] 2014-10-14\\
Fixed typographical error relating to details of IDCC 2015.
\item[v1.3] 2014-08-07\\
Added documentation of \lstinline|\conference| command. Improved display of footnotes, footnote markers and \texttt{itemize}\slash \texttt{enumerate} lists. Fixed a bug in the handling of author information. Fixed and improved how the transition from first to subsequent page geometry is achieved. Updated the details of IDCC 2015.
\item[v1.2] 2014-04-11\\
Added implementation, installation and licence sections to the Appendix of the documentation. Moved the majority of the file postamble information to the README, and synchronized the latter with the GitHub version. Improved the adaptation of \textsf{apacite} referencing to the house style.
\item[v1.1] 2014-03-06\\
Refactored the source for distribution through CTAN, and to allow the addition of the \textsf{idcc} class.
\item[v1.0] 2013-12-18\\
First public release of \textsf{ijdc-v9} class.
\end{description}

\newpage
\section{Appendix B: Implementation}

\lstset
  { aboveskip=1em plus 0.5em minus 0.2em
  , belowskip=1em plus 0.5em minus 0.2em
  , frame=single
  , numbers=left
  , numberstyle=\footnotesize\itshape
  , basicstyle=\footnotesize\ttfamily
  , breaklines=true
  , escapechar=
  }%
\useNiceVerb

\subsection{ijdc-v9.cls}

\renewcommand*{\mdJobName}{ijdc-v9}
\MakeInputJobDoc[cls]{0}{\ProcessInputWith{PScomment}}

\subsection{idcc.cls}

\renewcommand*{\mdJobName}{idcc}
\MakeInputJobDoc[cls]{0}{\ProcessInputWith{PScomment}}

\subsection{dccpaper-base.tex}

\renewcommand*{\mdJobName}{dccpaper-base}
\MakeInputJobDoc[tex]{0}{\ProcessInputWith{PScomment}}

\noNiceVerb

\newpage
\section{Appendix C: Installation}

\subsection{Managed way}

The latest stable release of the dccpaper bundle has been packaged for
\TeX\ Live and MiK\TeX. If you are running \TeX\ Live and have \texttt{tlmgr}
installed, you can install the bundle simply by running
\texttt{tlmgr install dccpaper}. If you are running MiK\TeX, you can
install the bundle by running \texttt{mpm -{}-install=dccpaper}. Both
\texttt{tlmgr} and \texttt{mpm} have GUI versions that you might find
friendlier.

\subsection{Automated way}

A makefile is provided which you can use with the Make utility:

\begin{itemize}
\item
  Running \texttt{make} generates the derived files

  \begin{itemize}
  \item
    README
  \item
    dccpaper.pdf
  \item
    ijdc-v9.cls
  \item
    idcc.cls
  \item
    dccpaper-base.tex
  \item
    dccpaper-apacite.bib
  \item
    dccpaper-biblatex.bib
  \end{itemize}
\item
  Running \texttt{make inst} installs the files in the user's \TeX\ tree.
\item
  Running \texttt{make install} installs the files in the local \TeX\
  tree.
\end{itemize}

\subsection{Manual way}

\begin{enumerate}
\item
  Compile dccpaper.dtx just as you would a normal \LaTeX\ file. Bear in
  mind the documentation requires the \textsf{biblatex} package and the Biber
  tool rather than regular Bib\TeX. As well as the usual PDF (or DVI) and
  auxiliary files, several others are generated.
\item
  Rename README.txt to README (if you like).
\item
  Move the files to your \TeX\ tree as follows:

  \begin{itemize}
  \item
    \path{source/latex/dccpaper}: dccpaper.dtx, dccpaper.ins
  \item
    \path{tex/latex/dccpaper}: ijdc-v9.cls, idcc.cls,
    dccpaper-base.tex, dccpaper-by.eps, dccpaper-by.pdf
  \item
    \path{doc/latex/dccpaper}: dccpaper.pdf, dccpaper-apacite.bib,
    dccpaper-biblatex.bib, README
  \end{itemize}
\item
  You may then have to update your installation's file name database
  before \TeX\ and friends can see the files.
\end{enumerate}

\newpage
\section{Appendix D: Sample Document}

The following code demonstrates how to use \textsf{dccpaper} to write a IDCC conference paper.

\begin{lstlisting}[frame=single]
\documentclass[research,15]{idcc}

\title{How to write a conference paper}
\author{Alex Ball}
\affil{Digital Curation Centre}
\author{Fred Bloggs}
\affil{University of Life}

\submitted{1 October 2014}

\usepackage[style=apa]{biblatex}
\addbibresource{references.bib}
\DeclareLanguageMapping{british}{british-apa}

\begin{document}
\maketitle

\begin{abstract}
Text of the abstract\dots
\end{abstract}

\section{Introduction}

The text of the introduction starts here\dots

\section{Conclusions}

The text of the conclusions starts here\dots

\section{Acknowledgements}

Any acknowledgements should be placed here\dots

\printbibliography
\end{document}
\end{lstlisting}

\newpage
\section{Appendix E: Licence}

Copyright \textcopyright\ 2015 Digital Curation Centre, University of Edinburgh.

This work consists of the image files dccpaper-by.eps and
dccpaper-by.pdf, the documented LaTeX file dccpaper.dtx and a Makefile.

The text files contained in this work may be distributed and/or modified
under the conditions of the
\href{http://www.latex-project.org/lppl.txt}{LaTeX Project Public
License (LPPL)}, either version 1.3c of this license or (at your option)
any later version.

The image files distributed with this bundle derive from the file
\href{http://mirrors.creativecommons.org/presskit/buttons/88x31/eps/by.eps}{by.eps}
distributed by Creative Commons. The image is a trademark of Creative
Commons and is subject to the
\href{http://creativecommons.org/policies}{Creative Commons trademark
policy}.

This work is ``maintained'' (as per LPPL maintenance status) by
\href{http://alexball.me.uk/}{Alex Ball}.

The file dccpaper.pdf, generated by this work, is licensed as shown on page 1.
\end{document}
%</driver>
% \fi
%
\endinput